<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8"> 
		<link rel="stylesheet" type="text/css" href="/assets/styles/styles.css">
		
		<link rel="stylesheet" type="text/css" href="/assets/styles/highlight.css">
		
		<title>The np problem, Reddit edition - foobuzz</title>
	</head>
	
	<body>
	<div id="main_wrapper">
	
		<header>
			<h1><a href="/">foobuzz</a></h1>
		</header>
		
		<nav>
			<ul id="navigation">
				<li><a href="/">Front</a></li>
			    <li><a href="/archives">Archives</a></li>
			    <li><a href="/about">About</a></li>
			</ul>

			
		 	<ul id="networking">
				
					<li><a href="https://twitter.com/_foobuzz"><img src="/assets/icons/twitbird.png" alt="The Twitter icon"></a></li>
				
				
					<li><a href="https://github.com/foobuzz"><img src="/assets/icons/github.png" alt="The GitHub icon"></a></li>
				
					<li><a href="/feed.xml"><img src="/assets/icons/atom.png" alt="The RSS/Atom icon"></a></li>
			</ul>
			
		</nav>
		
		<div id="main">
		
			<div id="content">

				

<article>

	<div class="entete">by Valentin, December 04 2015, in
		
		<a href="/tag/reddit">reddit</a>
		
	</div>

	<h1><a href="/reddit-np">The np problem, Reddit edition</a></h1>

	

<p>Have you ever been redirected to a so-called read-only version of Reddit? That's a thing. For example, check out <a href="https://np.reddit.com/r/books">np.reddit.com/r/books</a>. No voting arrows, no button to comment even when logged in, and a little message at the top of the subreddit: "You have been linked to a read-only version of this subreddit. Please respect the community by not voting." All because the little <code>np</code> ("No Participation") subdomain was used. Now if you try the same thing with /r/askreddit: <a href="np.reddit.com/r/askreddit">np.reddit.com/r/askreddit</a>, everything is absolutely normal, no difference with the regular Reddit. Quite strange, isn't it. It doesn't stop there. For example, <a href="https://sf.reddit.com/r/teenagers/">sf.reddit.com/r/teenagers</a> displays only the self-post of the subreddit, because of the <code>sf</code> (SelF-posts) subdomain. But that only works for /r/teenagers. So, what the well?</p>
<h2>How Reddit subdomains work</h2>
<p>One good thing about reddit is that it's open-source. So one can inspect <a href="https://github.com/reddit/reddit/blob/master/r2/r2/config/middleware.py#L201-L239">the code related to subdomains handling</a> to understand how it works. I did read the code, and this is what I discovered.</p>
<p>Reddit accepts subdomains that indicates the language with which the site should be displayed. What's interesting is that Reddit doesn't have a predefined list of strings that are accepted as a language subdomain, but uses a regular expression instead: <code>\A\w\w(-\w\w)?\Z</code>. So, basically, any sequence of two alphanumerical characters, optionally followed by a dash and another such sequence is accepted. For example, <code>zz</code> or <code>an-42</code> are valid language subdomains, even though they correspond to no language code in the <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1 specification</a>.</p>
<p>What does Reddit do with such code? Well, for some real languages such as French (<code>fr</code>) or Japanese (<code>ja</code>), the web interface is actually translated into the language. For the more esoteric codes that I invented in the paragraph above, it does nothing to the interface. However, for any given code, it performs one thing: in the HTML of the web page, it sets the value of the <code>lang</code> attribute of the <code>html</code> root tag to the code provided. So, when you browse to <a href="https://an-42.reddit.com/">an-42.reddit.com</a>, the HTML source of the page starts with:</p>
<div class="codehilite"><pre class="source"><code><span class="cp">&lt;!doctype html&gt;</span><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span> <span class="na">lang=</span><span class="s">"an-42"</span> <span class="na">xml:lang=</span><span class="s">"an-42"</span><span class="nt">&gt;</span>
</code></pre></div>
<h2>Using and abusing CSS</h2>
<p>On Reddit, despite doing the hard and benevolent work of maintaining subreddits, moderators have only access to quite rudimentary tools. Actually the improvement of moderator tools is always brought to the table when the admins risk themselves into asking the community for feedback. This issue was critical when last summer reddit let go the employee in charge of the relations between the moderators of /r/IamA and the celebrities doing interviews, all without warning the moderators, generating a <a href="http://www.dailydot.com/news/reddit-revolt-blackout-2015-ama-victoria/">massive reddit-wide drama</a>.</p>
<p>Anyway, it's a matter of fact that there are no moderator tools to customize the user experience depending on the subdomain used, nor tools to add custom modules or text areas anywhere in the subreddit page. However, the moderators have access to one thing: they can edit the CSS stylesheet used to render the subreddit. And that's the key to everything. CSS is like editing in film-making; no matter what material you have, you can transform it into whatever you want. CSS is power.</p>
<p>The basic idea is that if you prefix some CSS rules with the <code>body:lang(np)</code> selector, the rule will only apply to pages whose <code>html</code> tag have their <code>lang</code> attribute set to <code>np</code>. So, as a Reddit moderator, you can effectively define rules for specific subdomains. You can then use the power of CSS to fully customize the page for this subdomain. You can, especially, make things disappear using the <code>display: none</code> property:</p>
<div class="codehilite"><pre class="source"><code><span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="o">.</span><span class="na">usertext</span><span class="o">-</span><span class="n">edit</span><span class="o">,</span>
<span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="o">.</span><span class="na">sidebox</span><span class="o">.</span><span class="na">submit</span><span class="o">,</span>
<span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="o">.</span><span class="na">commentingAs</span><span class="o">,</span>
<span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="o">.</span><span class="na">markdownEditor</span><span class="o">,</span> 
<span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="n">a</span><span class="o">[</span><span class="n">onclick</span><span class="o">*=</span><span class="s2">"return reply(this)"</span><span class="o">],</span>
<span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="o">.</span><span class="na">helplink</span>
<span class="o">{</span>
    <span class="n">display</span><span class="o">:</span> <span class="n">none</span> <span class="o">!</span><span class="n">important</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>
<p>Additionally, you can make new things appear using the <code>content</code> CSS property coupled with the <code>:before</code> or <code>:after</code> selector:</p>
<div class="codehilite"><pre class="source"><code><span class="n">body</span><span class="o">:</span><span class="n">lang</span><span class="o">(</span><span class="n">np</span><span class="o">)</span> <span class="err">#</span><span class="n">siteTable</span><span class="o">:</span><span class="n">before</span>
<span class="o">{</span>
    <span class="n">content</span><span class="o">:</span> <span class="s2">"You have been linked to a read-only version of this subreddit. Please respect the community by not voting."</span><span class="o">;</span>
    <span class="n">display</span><span class="o">:</span> <span class="n">block</span><span class="o">;</span>
    <span class="n">max</span><span class="o">-</span><span class="n">width</span><span class="o">:</span> <span class="mi">800</span><span class="n">px</span><span class="o">;</span>
    <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="o">:</span> <span class="err">#</span><span class="n">F6E69F</span><span class="o">;</span>
    <span class="n">padding</span><span class="o">:</span> <span class="mi">5</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span><span class="o">;</span>
    <span class="n">margin</span><span class="o">:</span> <span class="mi">5</span><span class="n">px</span> <span class="mi">305</span><span class="n">px</span> <span class="mi">5</span><span class="n">px</span> <span class="mi">0</span><span class="n">px</span><span class="o">;</span>
    <span class="n">border</span><span class="o">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="n">orange</span><span class="o">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="o">:</span> <span class="n">small</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>
<p>A drawback of adding content using this method is that the inserted text is not selectable. This can be frustrating from a user-experience point of view.</p>
<p>The code snippets provided above come from the actual stylesheet provided by the /r/NoParticipation subreddit, which is dedicated to instruct moderators on how to "install" the "No Participation mode" on their own subreddits. In the next part, I explain how such a subreddit was born and why moderators would want to add a "No Participation mode" to their subreddit.</p>
<h2>Combating cross-subreddit contamination with the No Participation mode</h2>
<p>There are such things known as the <em>meta</em> subreddits. On such subreddits, users share links and comment about what happen on Reddit. For example, /r/BestOf is for comments which are awesome in some way and which constitutes the "best of" Reddit. /r/ThreadKillers is for comments which answer a question or a request in such a comprehensive way that any additional comment from other users is not necessary. /r/DepthHub is for comments which answer a question in depth. /r/SubredditDrama is for following flame-wars going on Reddit.</p>
<p>The subreddits these meta-subreddits link to sometimes are little subreddits or even <em>niche</em> subreddits, for example dedicated to specific hobbies. The problem is that meta-subreddits' users, instead of just being spectators of what's happening on Reddit, would sometimes go on and enter the show, voting on comments of the thread linked, posting comments themselves and so on. On top of disrupting the normal flow of upvotes and downvotes and disrespect the explicit and implicit submission guidelines of the subreddits they were showing up in, users would sometimes perform <em>vote brigading</em>, that is, massively downvoting a opinion they disagree with so that it would be buried in the abyss of the comments and become invisible.</p>
<p>To combat this problem, redditor /u/KortoloB had an idea. He figured out the technical elements explained in the previous part and wrote a "no participation" stylesheet dedicated to the <code>np</code> subdomain. This is the stylesheet which contain the snippets presented in the previous part. He created the subreddit <a href="https://www.reddit.com/r/noparticipation">/r/NoParticipation</a> to host and support his idea. He abstracted the technical working of the stylesheet into what he calls the <em>No Participation mode</em> and wrote instruction on how to install the No Participation mode on one's subreddit (basically instructing to copy and paste the stylesheet).</p>
<p>To make /u/KortoloB's idea work reddit-wide, there were two additional conditions: that regular subreddits install the No Participation Mode, and that the meta subreddits' submissions point to the No Participation mode of other subreddits. I don't know the exact time-line of events, but as of today, the NP mode is deployed on a lot of subreddits and the system works pretty well. <a href="https://www.reddit.com/r/NoParticipation/wiki/userlist">This page</a> lists all the subreddits that have No Participation installed, as well as meta-subreddits that instruct users to only post links pointing to the NP version of a subreddit, some of them requiring it (i.e. removing posts that don't respect the rule).</p>
<h2>Reaction of the community and of the reddit staff</h2>
<p>My impression as a regular redditor is that the No Participation thing caused and is still causing a lot of confusion in the Reddit community.</p>
<p>Most redditors know that moderators tools a quite limited and seeing voting arrows disappearing depending on the subdomain in the URL gives them the impression that the No Participation mode must be some kind of official Reddit feature. Furthermore, to even more discourage users to participate in the No Participation mode, some moderators launched the rumor that removing the <code>np</code> subdomain and reloading the page to participate would result in them being banned. However, moderators have no way to detect such behavior and admins have nothing to do with the No Participation mode. Technically, you don't even have to reload the page to participate, but just to disable the styles defined by the moderators. Since Reddit delivers the moderator stylesheet as a separate CSS file upon a client request, it's fairly easy with any browser's development tools to disable only the moderators styles.</p>
<p>When confused users would ask in several threads what the hell the No Participation mode was, some would answer by only giving a few bullet points about what this mode changed, in a tone that would validate the false idea that it's an official reddit feature. Some other would accurately explain that it's nothing more than a hack from the moderators that exploit the <code>np</code> language subdomain. Some would let think that moderators have a direct tool to customize a subreddit depending on the language, not clarifying that elements of the page are still there but just hidden. Fortunately, some other would accurately explain that it's a CSS hack.</p>
<p>A rumor that became popular is that the <code>np</code> language subdomain is for the Nepalese version of Reddit. In fact, the Nepalese language code is <code>ne</code>, not <code>np</code> (the <em>location</em> code of Nepal is <code>NP</code>, but Reddit's subdomain are not made for locations code). Furthermore, as explained in the first part of this article, Reddit accept any combination of two letters as the language subdomain. <code>np</code> corresponds to no language according to the ISO standard.</p>
<p>In the <a href="https://www.reddit.com/r/blog/comments/2c63wg/how_reddit_works">2014 thread</a> about the Reddit official blogpost <em>How reddit works</em>, when a user asked about the No Participation mode, the admin /u/cupcake1713 <a href="https://www.reddit.com/r/blog/comments/2c63wg/how_reddit_works/cjcbsda?context=1">clarified</a> that it wasn't actually something from the Reddit staff and called it a "crappy CSS hack" (and stroke the "crappy" out later, probably by remorse after No Participation creator answered to her comment and said being a little bit affected that his idea was denigrated so much by the admins). She also pointed out that the admins realized quite recently (relatively to the date of her comment) that the NP stylesheet was hiding the "report" button on submissions (a button to report abuse), that this was a "huge problem" and that if the staff would have spotted this problem sooner they would have stop the spread of this thing. The no participation stylesheet is since fixed and doesn't hide the report button.</p>
<p>Since then, other subreddits have customized other subdomains for other purposes (cf. <code>sf</code> on /r/teenagers for showing only self-posts). Last summer, admins said that they'll deploy better moderation tools by 2016. My bet is that it won't include any non-participation related stuff. It's too easy to override and it probably wouldn't scale well. I just want moderators to be able to add custom text boxes in the page without CSS so that the text is selectable. There's something deeply wrong with non-selectable text.</p>
	
</article>

<div id="front_nav">
	<a href="/foobar2000">Next</a>
	-
	<a href="/datetime-python">Previous</a>
</div>



			</div>
			
			<aside>
				<section>
					<h1>Last articles</h1>

					<ul>
						
							<li><a href="/foobar2000">The music I listen to</a></li>
						
							<li><a href="/reddit-np">The np problem, Reddit edition</a></li>
						
							<li><a href="/datetime-python">Datetime in Python</a></li>
						
							<li><a href="/firestory">Why Firefox was losing track of my history</a></li>
						
					</ul>
				</section>
				
				<section>
					<h1>Tags</h1>
					
					<ul>
						
							<li><a href="/tag/data">data</a> (2)</li>
						
							<li><a href="/tag/programming">programming</a> (1)</li>
						
							<li><a href="/tag/python">python</a> (2)</li>
						
							<li><a href="/tag/reddit">reddit</a> (1)</li>
						
							<li><a href="/tag/software">software</a> (2)</li>
						
					</ul>
				</section>
			</aside>
		
		</div>
		
		<footer>
			This blog and its articles are licensed under the <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International</a> license. This basically means that you can copy, share and remix the articles, provided that you give appropriate credit, indicate if changes were made, and that it is not for commercial use.
		</footer>
	
	</div>
	</body>

</html>